<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>10&nbsp; Risk Adjustment – The Tuva Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./readmissions.html" rel="prev">
<link href="./images/tuva-icon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-626149efe8f5d16e1d391ba177679bf0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./readmissions.html">Advanced Topics</a></li><li class="breadcrumb-item"><a href="./risk-adjustment.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Risk Adjustment</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">The Tuva Project</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./code-sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Code Sets</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Claims Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./claims-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Intro to Claims</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./claims-data-elements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Claims Data Elements</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./claims-adr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Adjustments, Denials, and Reversals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./provider-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Providers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./member-months.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Member Months</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./attribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Member Attribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./service-categories.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Service Categories</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./encounters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Encounters</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./readmissions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Readmissions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./risk-adjustment.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Risk Adjustment</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#what-is-risk-adjustment" id="toc-what-is-risk-adjustment" class="nav-link active" data-scroll-target="#what-is-risk-adjustment"><span class="header-section-number">10.1</span> What is risk adjustment?</a></li>
  <li><a href="#what-are-hccs" id="toc-what-are-hccs" class="nav-link" data-scroll-target="#what-are-hccs"><span class="header-section-number">10.2</span> What are HCCs?</a></li>
  <li><a href="#comparison-between-hhs-hcc-and-cms-hcc" id="toc-comparison-between-hhs-hcc-and-cms-hcc" class="nav-link" data-scroll-target="#comparison-between-hhs-hcc-and-cms-hcc"><span class="header-section-number">10.3</span> Comparison between HHS-HCC and CMS-HCC</a></li>
  <li><a href="#faq" id="toc-faq" class="nav-link" data-scroll-target="#faq"><span class="header-section-number">10.4</span> FAQ</a>
  <ul class="collapse">
  <li><a href="#footnotes" id="toc-footnotes" class="nav-link" data-scroll-target="#footnotes"><span class="header-section-number">10.4.1</span> Footnotes</a></li>
  </ul></li>
  <li><a href="#cms-risk-score-models" id="toc-cms-risk-score-models" class="nav-link" data-scroll-target="#cms-risk-score-models"><span class="header-section-number">10.5</span> CMS Risk Score Models</a></li>
  <li><a href="#risk-score-calculation" id="toc-risk-score-calculation" class="nav-link" data-scroll-target="#risk-score-calculation"><span class="header-section-number">10.6</span> Risk Score Calculation</a></li>
  <li><a href="#cms-risk-adjustment-files" id="toc-cms-risk-adjustment-files" class="nav-link" data-scroll-target="#cms-risk-adjustment-files"><span class="header-section-number">10.7</span> CMS Risk Adjustment Files</a>
  <ul class="collapse">
  <li><a href="#monthly-membership-detail-report-mmr" id="toc-monthly-membership-detail-report-mmr" class="nav-link" data-scroll-target="#monthly-membership-detail-report-mmr"><span class="header-section-number">10.7.1</span> Monthly Membership Detail Report (MMR)</a></li>
  <li><a href="#mao-004" id="toc-mao-004" class="nav-link" data-scroll-target="#mao-004"><span class="header-section-number">10.7.2</span> MAO-004</a></li>
  <li><a href="#model-output-report-mor" id="toc-model-output-report-mor" class="nav-link" data-scroll-target="#model-output-report-mor"><span class="header-section-number">10.7.3</span> Model Output Report (MOR)</a></li>
  </ul></li>
  <li><a href="#sample-risk-score-calculation-of-a-single-patient" id="toc-sample-risk-score-calculation-of-a-single-patient" class="nav-link" data-scroll-target="#sample-risk-score-calculation-of-a-single-patient"><span class="header-section-number">10.8</span> Sample Risk Score Calculation of a single patient</a>
  <ul class="collapse">
  <li><a href="#calculate-the-demographic-score" id="toc-calculate-the-demographic-score" class="nav-link" data-scroll-target="#calculate-the-demographic-score"><span class="header-section-number">10.8.1</span> Calculate the demographic score</a></li>
  <li><a href="#calculate-the-disease-score" id="toc-calculate-the-disease-score" class="nav-link" data-scroll-target="#calculate-the-disease-score"><span class="header-section-number">10.8.2</span> Calculate the Disease Score</a></li>
  <li><a href="#bringing-it-all-together" id="toc-bringing-it-all-together" class="nav-link" data-scroll-target="#bringing-it-all-together"><span class="header-section-number">10.8.3</span> Bringing it all together</a></li>
  <li><a href="#but-wait-theres-more" id="toc-but-wait-theres-more" class="nav-link" data-scroll-target="#but-wait-theres-more"><span class="header-section-number">10.8.4</span> But wait! There’s more</a></li>
  <li><a href="#additional-notes" id="toc-additional-notes" class="nav-link" data-scroll-target="#additional-notes"><span class="header-section-number">10.8.5</span> Additional notes</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">10.8.6</span> References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./readmissions.html">Advanced Topics</a></li><li class="breadcrumb-item"><a href="./risk-adjustment.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Risk Adjustment</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Risk Adjustment</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="what-is-risk-adjustment" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="what-is-risk-adjustment"><span class="header-section-number">10.1</span> What is risk adjustment?</h2>
<p>Risk adjustment was developed and created to dissuade payers from selectively enrolling patients who are healthy into health plans and make sure payers are compensated fairly for the illness burden of patients. Risk adjustment models are used to calculate payments to healthcare organizations for patients insured by: * Medicare Advantage * Accountable Care Organizations * Most Affordable Care Act plans. <a href="#footnotes">[1]</a></p>
<p>At a high level, if a patient is sicker or has higher predicted medical cost, the payer insuring that patient will be compensated more.</p>
<p>A Risk Adjustment Factor Score (“RAF score”) is a measure of the estimated cost of an individual’s care based on demographic factors such as age and gender and their associated disease factors (how costly/sick is the individual patient). This RAF score is then used to calculate payments or reimbursements to these organizations.</p>
<p>There are multiple risk adjustment models that exist for both Medicare patients and commercial patients. The most common risk adjustment models are:</p>
<ul>
<li>HHS-HCC</li>
<li>CMS-HCC NON-ESRD</li>
<li>CMS-HCC ESRD</li>
<li>RxHCC</li>
<li>PACE <a href="#footnotes">[2]</a></li>
</ul>
<p>Each risk adjustment model has in common that it tries to predict medical expense using demographic information and disease factors for patients.</p>
</section>
<section id="what-are-hccs" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="what-are-hccs"><span class="header-section-number">10.2</span> What are HCCs?</h2>
<p>“HCC” stands for Hierarchical Condition Categories. They are sets of medical codes linked to clinical diagnoses that aim to predict cost for acute and chronic health conditions. HCC coding relies on ICD-10-CM coding to assign risk scores to patients. Not all risk adjustment models have to use HCCs, but almost all do.</p>
</section>
<section id="comparison-between-hhs-hcc-and-cms-hcc" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="comparison-between-hhs-hcc-and-cms-hcc"><span class="header-section-number">10.3</span> Comparison between HHS-HCC and CMS-HCC</h2>
<p>One way to separate HHS and CMS HCC models would be to call them respectively “commercial risk adjustment” (HHS) and “Medicare risk adjustment” (CMS). These two main models are similar but are separate:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 52%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th><strong>CMS-HCC Model</strong></th>
<th><strong>HHS-HCC Model</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Used for Medicare</td>
<td>Used for Affordable Healthcare Act (ACA) plans</td>
</tr>
<tr class="even">
<td>Base year informs next year’s payment</td>
<td>Current year diagnoses inform current year payment</td>
</tr>
<tr class="odd">
<td>Focused on patients 65 and older, but can include younger disabled population</td>
<td>Focused on all ages</td>
</tr>
<tr class="even">
<td>Drug costs are carved out in separate model</td>
<td>Drug costs are included</td>
</tr>
<tr class="odd">
<td>Has distinct model and break out for ESRD patients</td>
<td>Does not carve out ESRD in separate risk adjustment model</td>
</tr>
<tr class="even">
<td>Is not a zero-sum payment system</td>
<td>Is zero-sum between payers that participate in ACA</td>
</tr>
<tr class="odd">
<td>Has Normalization Factor and Coding Pattern Difference Adjustment</td>
<td>Has final adjustment for CSR benefit curve and utilization differences</td>
</tr>
</tbody>
</table>
</section>
<section id="faq" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="faq"><span class="header-section-number">10.4</span> FAQ</h2>
<section id="what-does-zero-sum-mean" class="level4" data-number="10.4.0.1">
<h4 data-number="10.4.0.1" class="anchored" data-anchor-id="what-does-zero-sum-mean"><span class="header-section-number">10.4.0.1</span> What does zero-sum mean?</h4>
<p>Zero-sum in the context of commercial risk adjustment (HHS-HCC Model) means that there is no government subsidization for private companies in the risk adjustment process. If the illness burden of a state in total increases from the prior year, the government provides no additional funds. What happens during reconciliation is some health insurance companies will have to pay into a pool because they have healthier than average patients. Some organizations will get paid out from that pool because they have sicker than average patients. The total transfer of dollars adds up to $0.</p>
</section>
<section id="if-risk-scores-inform-payments-how-are-risk-scores-checked-to-make-sure-they-are-not-overinflated" class="level4" data-number="10.4.0.2">
<h4 data-number="10.4.0.2" class="anchored" data-anchor-id="if-risk-scores-inform-payments-how-are-risk-scores-checked-to-make-sure-they-are-not-overinflated"><span class="header-section-number">10.4.0.2</span> If risk scores inform payments, how are risk scores checked to make sure they are not overinflated?</h4>
<p>Both HHS-HCC and CMS-HCC models go through a validation process which is called “Risk Adjustment Data Validation” (aka RADV). The RADV processes and procedures are different for different risk adjustment models.</p>
</section>
<section id="can-you-compare-risk-scores-between-years-to-see-the-illness-burden-of-a-patient-change-over-time" class="level4" data-number="10.4.0.3">
<h4 data-number="10.4.0.3" class="anchored" data-anchor-id="can-you-compare-risk-scores-between-years-to-see-the-illness-burden-of-a-patient-change-over-time"><span class="header-section-number">10.4.0.3</span> Can you compare risk scores between years to see the illness burden of a patient change over time?</h4>
<p>This can be done, but is not recommended, especially if using different risk adjustment models between different years. There may be other models that can more accurately reflect illness burden, and risk adjustment is mainly focused on predicted medical expenditure. These two things are correlated, but not necessarily the same.</p>
</section>
<section id="footnotes" class="level3" data-number="10.4.1">
<h3 data-number="10.4.1" class="anchored" data-anchor-id="footnotes"><span class="header-section-number">10.4.1</span> Footnotes</h3>
<p>[1] ACA health plans that are not subject to risk adjustment are Grandfathered plans, Short-term, limited-duration plans, Health Reimbursement Arrangements (HRAs), and plans offered by states that have received a waiver from HHS.</p>
<p>[2] Program of All Inclusive Care for the Elderly</p>
</section>
</section>
<section id="cms-risk-score-models" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="cms-risk-score-models"><span class="header-section-number">10.5</span> CMS Risk Score Models</h2>
<p>CMS has implemented multiple models to address differences in program costs and the beneficiary population. For example, Medicare Part C versus Medicare Part D plans, the ESRD population (End-Stage Renal Disease) versus members without ESRD, or members enrolled in the Program of All Inclusive Care for the Elderly (PACE). CMS also segments each model, creating subpopulations with distinct cost patterns, such as dual enrollment in Medicaid or living in the community versus an institution.</p>
<p>The full list of models are:</p>
<ul>
<li>CMS-HCC</li>
<li>CMS-HCC-ESRD</li>
<li>PACE</li>
<li>RxHCC</li>
</ul>
<p>In addition to models for different populations, CMS has released versions of these models over the years, which include new HCC mappings and added or removed ICD-10-CM codes. Version 24 has been in use since 2020. Version 28 will be phased in over a three-year period starting in 2024.</p>
<ul>
<li>Payment year 2024 risk scores will be blended using 67% of the risk score calculated from v24 and 33% from v28.</li>
<li>Payment year 2025 risk scores will be blended using 33% of the risk score calculated from v24 and 67% from v28.</li>
<li>Beginning in payment year 2026 risk scores will be 100% from v28.</li>
</ul>
<p>CMS also performs model calibration based on diagnostic and expenditure data. These changes can be found in the annual rate announcements on <a href="https://www.cms.gov/Medicare/Health-Plans/MedicareAdvtgSpecRateStats/Announcements-and-Documents">cms.gov</a>.</p>
<p>These models generate risk scores by adding relative risk factors, demographics, and disease information. Additionally, they use hierarchies where the most severe manifestation of a condition is considered for risk scores.</p>
</section>
<section id="risk-score-calculation" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="risk-score-calculation"><span class="header-section-number">10.6</span> Risk Score Calculation</h2>
<p>Several resources are needed to calculate risk scores.</p>
<ul>
<li>Annual Rate Announcements for the applicable payment year (found on <a href="https://www.cms.gov/Medicare/Health-Plans/MedicareAdvtgSpecRateStats/Announcements-and-Documents">cms.gov</a>)</li>
<li>ICD-10-CM to HCC mapping (found on <a href="https://www.cms.gov/medicare/health-plans/medicareadvtgspecratestats/risk-adjustors">cms.gov</a>)</li>
<li>Risk adjustment model software (CMS makes a SAS program available on <a href="https://www.cms.gov/medicare/health-plans/medicareadvtgspecratestats/risk-adjustors">cms.gov</a>)</li>
<li>Model Output Report (MOR) or claims data</li>
<li>Monthly Membership Detail Report or eligibility data</li>
</ul>
<p>Once you have gathered the resources needed to calculate risk scores, you can begin identifying and calculating scores for your patients. A brief overview of the steps:</p>
<ol type="1">
<li>Identify demographic and enrollment information for each patient and cross-reference the risk factor value from the appropriate payment year’s rate announcement document.</li>
<li>Identify disease information for each patient, apply the condition hierarchy, and cross-reference the risk factor value from the appropriate payment year’s rate announcement document.</li>
<li>Identify additional relative and adjustment factors, such as disease and disabled interactions, and total HCC counts per patient, and cross-reference the risk factor value from the appropriate payment year’s rate announcement document.</li>
<li>Calculate the raw risk scores for each patient, then apply the normalization factors and the MA coding pattern adjustment factors from the appropriate payment year’s rate announcement document to calculate the normalized and payment risk scores.</li>
</ol>
</section>
<section id="cms-risk-adjustment-files" class="level2" data-number="10.7">
<h2 data-number="10.7" class="anchored" data-anchor-id="cms-risk-adjustment-files"><span class="header-section-number">10.7</span> CMS Risk Adjustment Files</h2>
<p>The Monthly Membership Detail Report (MMR) and Model Output Report (MOR) are two types of files that CMS sends to Medicare Advantage organizations (MAOs). The files, in additional to other resources from CMS, are used to calculate the CMS HCC risk adjustment factor (RAF) scores.</p>
<p>CMS shares these files through the Medicare Advantage Prescription Drug (MARx) system and through the Health Plan Management System (HPMS).</p>
<p>MAOs can refer to the Plan Communications User Guide (<a href="https://www.cms.gov/files/document/plan-communications-user-guide-august-31-2023-v172.pdf">PCUG</a>) for additional details on the files exchanged through the MARx system.</p>
<section id="monthly-membership-detail-report-mmr" class="level3" data-number="10.7.1">
<h3 data-number="10.7.1" class="anchored" data-anchor-id="monthly-membership-detail-report-mmr"><span class="header-section-number">10.7.1</span> Monthly Membership Detail Report (MMR)</h3>
<p>The MMRs contain member eligibility, risk scores, and prospective payments the MAO receives for each member in the upcoming month. They also contain retroactive adjustments to prior months’ records. This file contains the data for both Part C and Part D members. The key pieces of data to get from the MMR are:</p>
<ul>
<li><strong>Eligibility</strong>: Understanding eligibility is a pre-requisite for modeling risk adjustment. The MMR has very detailed information regarding eligibility, including retrospective enrollments and disenrollment data. Just because a member exists in the MMR file, does not mean that they are eligible and should be included in risk adjustment.</li>
<li><strong>Segment / Risk Model</strong>: Depending on the risk adjustment model being used (most commonly v24 and v28), different co-efficients are used for the member based on if they are newly enrolled, are dual status, and their <a href="https://resdac.org/cms-data/variables/medicare-status-code-january">medicare status code</a>. This information needs to be gathered from the MMR to calculate risk adjustment</li>
<li><strong>Risk Scores</strong>: The MMR will also disclose risk scores for a patient but only for certain time periods (start of the year, mid-year, and final). This can be used to understand funded premium, or validate calculated risk scores.</li>
</ul>
</section>
<section id="mao-004" class="level3" data-number="10.7.2">
<h3 data-number="10.7.2" class="anchored" data-anchor-id="mao-004"><span class="header-section-number">10.7.2</span> MAO-004</h3>
<p>Not all medical claims are eligible for documenting HCCs for medicare risk adjustment. To address this, CMS provides a report called the MAO-004 which will inform Medicare Advantage organizations if a given diagnosis code submitted is eligible for risk adjustment. This file can be helpful for tying out risk score calculations to the MMR.</p>
</section>
<section id="model-output-report-mor" class="level3" data-number="10.7.3">
<h3 data-number="10.7.3" class="anchored" data-anchor-id="model-output-report-mor"><span class="header-section-number">10.7.3</span> Model Output Report (MOR)</h3>
<p>Similar to MMRs, the MORs contain a record for each member. That record shows the Hierarchical Condition Codes (HCCs) for each member used by the Risk Adjustment System (RAS) to calculate Part C or Part D risk adjustment factors for each beneficiary. There are two varieties of MORs, for Parts C and D respectively, as each uses different models.</p>
<p>In addition to these monthly files, CMS issues “final” MORs once per year with updated information after the year has ended, and planned runout data has been collected.</p>
</section>
</section>
<section id="sample-risk-score-calculation-of-a-single-patient" class="level2" data-number="10.8">
<h2 data-number="10.8" class="anchored" data-anchor-id="sample-risk-score-calculation-of-a-single-patient"><span class="header-section-number">10.8</span> Sample Risk Score Calculation of a single patient</h2>
<p>Let’s walk through a single example with a single patient as to how the risk score is calculated in the context of medicare advantage for the year 2024.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./img/cms_hccs/risk_adj_overview_single_patient_example.drawio.svg" class="img-fluid figure-img"></p>
<figcaption>Overview</figcaption>
</figure>
</div>
<p>Here’s some information about this patient.</p>
<ul>
<li>Patient is Female (<a href="https://resdac.org/cms-data/variables/sex-beneficiary">BENE_SEX_CD</a> = 2)</li>
<li>Patient is 76 years old</li>
<li>Patient is a partial dual patient (<a href="https://resdac.org/cms-data/variables/medicare-medicaid-dual-eligibility-code-january">DUAL_ELGBL_CD_01</a> = 03)</li>
<li>Patient is aged without ESRD (<a href="https://resdac.org/cms-data/variables/medicare-status-code-january">MDCR_STATUS_CODE_01</a> = 10)</li>
<li>Patient was originally disabled (<a href="https://resdac.org/cms-data/variables/medicare-original-reason-entitlement-code-orec">MDCR_OREC</a> = 1)</li>
<li>Patient has the following diagnosis documented in medical claims submitted to cms:</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 88%">
</colgroup>
<thead>
<tr class="header">
<th>Diagnosis Code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>E10641</td>
<td>Type 1 diabetes mellitus with hypoglycemia with coma</td>
</tr>
<tr class="even">
<td>E083293</td>
<td>Diabetes mellitus due to underlying condition with mild nonproliferative diabetic retinopathy without macular edema, bilateral</td>
</tr>
<tr class="odd">
<td>E139</td>
<td>Other specified diabetes mellitus without complications</td>
</tr>
<tr class="even">
<td>E139</td>
<td>Other specified diabetes mellitus without complications</td>
</tr>
</tbody>
</table>
<p>Walking through the steps listed above:</p>
<section id="calculate-the-demographic-score" class="level3" data-number="10.8.1">
<h3 data-number="10.8.1" class="anchored" data-anchor-id="calculate-the-demographic-score"><span class="header-section-number">10.8.1</span> Calculate the demographic score</h3>
<p>To calculate the demographics portion of the risk score, we need to look at the demographics information for the patient provided above. Let’s take a look at a table from the <a href="https://www.cms.gov/files/document/2024-announcement-pdf.pdf">2024 final rule</a> that contains the raw factors related to demographics.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./img/cms_hccs/Demographics_Score_2024_Final_Rule.png" class="img-fluid figure-img"></p>
<figcaption>2024_Final_Rule_Demographics_Table</figcaption>
</figure>
</div>
<ul>
<li>The demographic score for a female patient 76 years of age with partial dual status is 0.485.</li>
<li>Given the patient has been originally disabled, they get an additional 0.103.</li>
</ul>
<p>The final raw risk from demographics is (0.485 + 0.103) = <strong>0.588</strong></p>
<p>If the patient was an end stage renal disease (ESRD) patient, we would use a separate demographics table that uses the ESRD risk adjustment model.</p>
</section>
<section id="calculate-the-disease-score" class="level3" data-number="10.8.2">
<h3 data-number="10.8.2" class="anchored" data-anchor-id="calculate-the-disease-score"><span class="header-section-number">10.8.2</span> Calculate the Disease Score</h3>
<p>The disease score can be sourced from multiple places, either the MOR or claims data in combination with MAO-004 report. This example will be looking at calculating risk from claims data.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./img/cms_hccs/risk_adj_disease_score_single_patient_example.drawio.svg" class="img-fluid figure-img"></p>
<figcaption>disease_score_calculation</figcaption>
</figure>
</div>
<p>In the sample patient, the diagnosis codes for that patient are provided above from claims data. Not all diagnosis are accepted for risk adjustment, so in this example we will say the diagnosis E10.641, (Type 1 diabetes mellitus with hypoglycemia with coma) is not accepted when checking the MAO-004. That leaves two diagnosis of E08.3293 and E13.9. Even though E13.9 is present twice in claims data, having more than one of the same accepted diagnosis code is the same as having a single instance of that diagnosis code being accepted.</p>
<p>Next we need to cross-reference the diagnosis codes to get the HCCs for the model. The crosswalk between diagnosis codes and HCCs can be found <a href="https://www.cms.gov/medicare/health-plans/medicareadvtgspecratestats/risk-adjustors/2024-model-software/icd-10-mappings">here</a> under “2024 Initial ICD-10 Mappings”.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./img/cms_hccs/diagnosis_to_hcc_crosswalk_example.png" class="img-fluid figure-img"></p>
<figcaption>diagnosis_to_hcc_crosswalk_example</figcaption>
</figure>
</div>
<p>When looking up the two diagnosis codes in the crosswalk, we see they are both valid and map to two HCCs for the 2024 v28 risk adjustment model (37 and 38).</p>
<p>Next we need to check the hierarchy to drop HCCs that exist within the hierarchy. This hierarchy exists within the <a href="https://www.cms.gov/files/document/2024-announcement-pdf.pdf">announcement document</a>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./img/cms_hccs/hcc_hierarchy_2024_final_rule.png" class="img-fluid figure-img"></p>
<figcaption>hcc_hierarchy_2024_final_rule</figcaption>
</figure>
</div>
<p>Based on this table, we see that HCC-37 is on the left hand side “If the Disease Group is listed in this column…” and on the right hand side “…Then drop the CMS-HCC listed in this column” there is a match on HCC-38. This means that we drop the HCC-38 and are left with a single remaining HCC (HCC-37) for this patient.</p>
<p>Once we have our remaining HCCs after the hierarchy is applied, we need to find the score related to HCC-37 for this single patient example. If there was more than one HCC remaining, the values would be summed,</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./img/cms_hccs/disease_coefficients_v28_2024_announcement.png" class="img-fluid figure-img"></p>
<figcaption>disease_coefficients_v28_2024_announcement</figcaption>
</figure>
</div>
<p>For this patient the score is <strong>0.166</strong>.</p>
<p>Next we need to evaluate disease interactions. Since we are left with only a single HCC, disease interactions don’t apply for this specific example patient. However, please see below for the disease interactions that exist within the v28 model. This is also in the <a href="https://www.cms.gov/files/document/2024-announcement-pdf.pdf">announcement document</a>.</p>
<p><img src="./img/cms_hccs/disease_interactions_2024_final_rule.png" class="img-fluid" alt="disease_interactions_2024_final_rule"> <img src="./img/cms_hccs/disease_interaction_v28_2024_announcement.png" class="img-fluid" alt="disease_interaction_v28_2024_announcement"></p>
<p>Finally, we need to count the number of HCCs remaining after the application of the hierarchy. In this example, we only have a single HCC, so there is no additional score applied.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./img/cms_hccs/hcc_counts_2024_announcement.png" class="img-fluid figure-img"></p>
<figcaption>hcc_counts_2024_announcement</figcaption>
</figure>
</div>
</section>
<section id="bringing-it-all-together" class="level3" data-number="10.8.3">
<h3 data-number="10.8.3" class="anchored" data-anchor-id="bringing-it-all-together"><span class="header-section-number">10.8.3</span> Bringing it all together</h3>
<p>We sum both the demographic score and the disease score to get the final raw raf for the patient. (0.588 + 0.166) = <strong>0.754</strong>. This score is the raw risk score for the patient. To get the final risk score for a patient, the formula is (raw_risk_score / normalization_factor).</p>
<p>For 2024, the CMS-HCC risk adjustment model normalization factor is <strong>1.015</strong> meaning. For <strong>medicare advantage</strong> organizations, another Coding Pattern Difference Adjustment (aka Coding Intensity Factor CIF) of <a href="https://uscode.house.gov/view.xhtml?req=(title:42%20section:1395w-23%20edition:prelim)">5.9%</a> should be applied on top of the normalization factor.</p>
<p>So the final risk score for this single patient would be (0.754 / 1.015) * (1 - 0.059) = <strong>0.699</strong></p>
</section>
<section id="but-wait-theres-more" class="level3" data-number="10.8.4">
<h3 data-number="10.8.4" class="anchored" data-anchor-id="but-wait-theres-more"><span class="header-section-number">10.8.4</span> But wait! There’s more</h3>
<p>In the above example, it only looked at the scores and weights for a single risk adjustment model, v28. However, for medicare advantage organizations in the year 2024, final funded risk is not based solely on the outputs of the v28 risk adjustment model. There is a transition period where risk will be determined with a blended model, where 33% of the risk score will be weighted with the v28 model and 67% of the risk score will be weighted with the v24 risk adjustment model.</p>
<p>What does this mean? This means we have to go back and repeat the steps prior to “Bringing it all together” for the v24 risk adjustment model, then apply the 33% and 67% weighting for v28 and v24 risk scores respectively, then apply normalization factor and CIF to get the final risk score for the patient.</p>
</section>
<section id="additional-notes" class="level3" data-number="10.8.5">
<h3 data-number="10.8.5" class="anchored" data-anchor-id="additional-notes"><span class="header-section-number">10.8.5</span> Additional notes</h3>
<ul>
<li>In this specific example, this was looking at the risk adjustment model for Medicare Advantage. Different programs and different use cases can use different risk adjustment models.</li>
<li>Different years going forward (2025 and 2026) have different weighting of the v24 vs v28 risk adjustment models.</li>
<li>This can all be subject to change if there is new legislation or final rules for 2025 and 2026.</li>
<li>In the context of some CMMI programs, the terms of “coding intensity factor” and “normalization factor” can seem to be the same as the Medicare Advantage definitions, but can be derived in different ways specific to that program.</li>
</ul>
</section>
<section id="references" class="level3" data-number="10.8.6">
<h3 data-number="10.8.6" class="anchored" data-anchor-id="references"><span class="header-section-number">10.8.6</span> References</h3>
<ul>
<li>https://www.milliman.com/en/insight/medicare-advantage-and-the-encounter-data-processing-system-be-prepared</li>
<li>https://www.cms.gov/files/document/2024-advance-notice-pdf.pdf</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./readmissions.html" class="pagination-link" aria-label="Readmissions">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Readmissions</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




</body></html>